from random import randrange
import torch
import torchvision
import torch.nn as nn
import numpy as np
import random

x_values =  [27.655935748000214, 49.51368552552744, 85.55944217385687, 24.639620421214136, 92.96943987841446, 17.46654632528348, 4.970153026252588, 27.450763795111722, 25.325440013241597, 48.71042395155711, 82.62100106852269, 50.51201466253102, 97.7436227721382, 41.70027284176272, 89.17330741404727, 66.10509745927729, 93.85197160379174, 32.76940293600955, 91.06271651791928, 48.01203973828149, 62.72482982915908, 33.68842725267361, 25.840498915582376, 62.574974586228734, 53.210769813281985, 52.39057637876281, 3.4197768585136235, 33.20056244833458, 91.50451863903729, 17.358005115547638, 17.212157836895802, 53.1595106009093, 41.61459989080544, 82.98437255318507, 46.29651327759985, 78.60889967850862, 11.198267952547925, 64.06912742013553, 22.929582813586446, 69.6275949474735, 69.06038967947607, 79.36527450738406, 16.11337135551265, 30.018857178730883, 1.4665130115830927, 86.35780021872813, 46.17309902431551, 18.48754329900968, 96.2546857201703, 43.005710201140026, 34.40475506127437, 10.339172930242512, 92.47317992106657, 81.25965283054988, 28.875242484567753, 31.88854756279205, 84.96648576081019, 58.51983672159389, 44.27394500375881, 73.20546028677964, 71.80860017009458, 94.48848654631773, 67.99244120113117, 11.898369025554445, 71.76309343125149, 52.63750505992603, 33.014915517147, 62.79755417083802, 64.10859422607436, 63.65917622867904, 65.81691842819669, 17.767357883680834, 49.187287066847986, 58.40676674644527, 47.49204630894045, 23.426622653807105, 21.14761927921701, 60.97394018280011, 14.411015619149826, 71.55900659675389, 9.49933704093292, 46.62325663996807, 82.16138067567694, 32.13184394168053, 1.357494773718193, 32.209486739887105, 20.83779193951113, 90.22845440767425, 82.59686853342033, 34.49555055378119, 67.46027591361963, 49.57849760361973, 10.955108942666259, 37.555327712450826, 21.388501060508002, 13.96325734553896, 8.89324329301624, 41.27474908865763, 89.95652351396338, 88.30794407001544, 26.412504801265847, 91.51751376998303, 12.853546225286793, 76.48947200993253, 54.49462055855998, 27.615059487728487, 33.440450114771366, 0.06609741642500389, 34.65666268995605, 99.49868875739438, 37.552625056162384, 48.05032785111868, 91.7497440290663, 9.570950325295179, 64.86259118109369, 92.65524130226869, 48.54991112936886, 47.876269814076856, 95.4512936162144, 57.21682274360763, 56.93698803049937, 11.414441802657027, 78.21230125385317, 82.7225752260014, 58.24734396660066, 82.12831456134606, 3.2361042943573337, 46.67045159314975, 67.4324938760029, 24.748652234083202, 61.421971158513045, 14.210253304138131, 90.30578400057907, 91.5143656428983, 10.203237944462206, 25.128616954772053, 70.91501898065114, 70.6125734661727, 76.85561590810981, 84.0471416192729, 26.216227332895436, 21.398868959345606, 87.1935264960518, 56.71018796966884, 92.10996063661769, 34.11097242547859, 6.864884442570185, 51.47690687633036, 53.29613439356082, 43.92366490440528, 88.18021401969467, 27.042716122657396, 0.44900133374762285, 54.59310749173479, 83.29890545455932, 51.15590173533637, 84.5560868540214, 50.38643694853203, 3.908647842344737, 36.77921680628508, 79.92414140889734, 43.95347527960472, 12.21119281885631, 59.319241374164044, 29.580574511887182, 77.62953016997376, 37.84616474804904, 92.40989340803914, 32.500546363992655, 22.498399584081895, 64.34063592132301, 5.062720412919397, 19.26979002490883, 14.845617005571455, 86.76517599894986, 64.80400326568338, 53.752036038604146, 17.344247076726006, 66.5859468636043, 95.29357529244787, 59.60151376370878, 66.71255880312195, 2.949208992272845, 40.50749724482492, 77.65009328378136, 16.25683182326125, 17.41727678123758, 6.0445705474588385, 1.9814973184610785, 44.56137807061851, 24.17396081540423, 5.304123352817635, 83.8193713408235, 40.88403926792877, 23.677296450796938, 56.3233552086337, 16.813326637315175, 3.0078874671225275, 7.224125014784377, 70.15831411651995, 72.37875005947532, 59.932923507186885, 51.72883551178488, 74.65301161606457, 56.42719875307398, 31.997893359729403, 74.818078272549, 63.30551238698984, 21.099529998597376, 37.02669394038377, 35.963498193789334, 53.85621847027635, 93.78920120909726, 49.81593687517459, 38.12788705306336, 98.40526770620131, 94.35205318714056, 52.307617202821746, 70.25766726173786, 10.048882336219844, 60.01528388142281, 36.06174542017965, 36.23075862761137, 5.062635635293655, 77.64490084014774, 51.25762755372661, 0.34935711182964013, 12.753945565868307, 64.13064796777549, 59.377186192295206, 92.18212531963628, 35.27755797657179, 98.70854550904909, 18.031729603083946, 86.76649106670585, 69.06184367477205, 9.145728294748146, 89.58687072319002, 91.49436310320517, 10.302670336546582, 78.3966823302062, 37.34374604029328, 73.71638272219465, 67.65627276140694, 65.38362103397394, 1.1926476395103913, 74.14372383569582, 68.30355413490378, 12.107558050689239, 60.981256764207856, 47.015398063802, 42.42202960222442, 77.33686740485457, 56.855101014958464, 41.2879131803627, 87.18597816760573, 3.5603290338804494, 6.869216880318618, 56.983705724039815, 56.30736459415642, 41.43220347798176, 79.20154073947059, 96.04103771597177, 71.47532947633478, 27.837019477052227, 1.3977799027582227, 40.01504573370016, 92.53612212472629, 57.482937282008386, 91.34035753149206, 96.49579600223512, 46.95904736887795, 22.92785224658346, 46.64124704426046, 81.20145583872768, 50.06161269716088, 4.2698992411035475, 91.2343477710257, 58.44899459473618, 74.2057141566757, 62.35627480615923, 32.41506638490977, 78.88968569895978, 84.72988459145296, 98.83206624944405, 81.03069707364693, 70.93261414801223, 35.111957040490424, 8.361764629372326, 61.55461052762775, 3.6406427301878597, 47.008299227115124, 24.836217348838662, 7.508332287753062, 94.68877128306598, 12.556990060577144, 60.385922439177286, 14.878333633677233, 75.17535214879433, 43.71602136056345, 47.85268320551923, 66.16456471472506, 67.0508798060168, 64.35613915507923, 3.493812080107883, 5.46566046467073, 90.27558480088683, 47.123937359756916, 17.546151615291528, 12.948462216805801, 72.92703969347282, 89.76984103818985, 93.74339429337574, 33.44345243731532, 57.720301586710576, 22.106904620589418, 90.70185715225318, 72.04885514784436, 33.840345699958384, 93.85564877450332, 11.36531870847084, 24.534700493124372, 22.356418367094054, 76.71111506574888, 4.058398551066144, 25.323588930820563, 41.266971277352724, 61.85505898797102, 50.75720808817257, 85.67819481347914, 84.58683696090601, 57.91931061478692, 19.597575247806244, 11.699182697847732, 25.546208280863603, 23.36360895782895, 43.31943391152754, 27.67460640719269, 94.76302447806923, 46.945838471186406, 27.592768295767335, 20.431814155768645, 66.30254951699878, 72.85651387209677, 84.13593551231406, 35.71428383073012, 31.796773250426536, 21.293510602401877, 15.320471558922167, 28.742376830305904, 18.07769766199243, 4.8201141005413835, 86.96845289653012, 57.18450240096279, 89.42518862042684, 81.7319532404022, 14.600870064271888, 88.44868298085264, 79.6416632900825, 68.06740044475123, 28.65375821449929, 87.73277796164957, 31.27313919738097, 51.27182841909392, 72.72859926321279, 66.24218911178035, 87.87806462843693, 83.90362013733967, 95.68870398499283, 65.51958439007028, 81.45803374110217, 6.892793465644775, 4.755153923816802, 17.429104192416233, 9.60490596374286, 75.56351644096995, 57.73834111727712, 25.92852038515264, 21.295959761438954, 28.112510036402472, 48.89888217012622, 23.92620862608441, 41.299536281174795, 4.33506874656806, 81.89885754375587, 26.479656089071433, 34.24921040663974, 68.406322439587, 90.49709845417351, 65.23833082257549, 34.464147495773325, 15.978185365687935, 54.66459307411184, 31.35092716457063, 51.18008459877921, 38.69052421568371, 25.574923469713383, 9.710352404960998, 20.744490257108673, 38.812532231184214, 22.430906441454812, 93.67910176404001, 20.901303101341696, 86.63544065539861, 35.96377435099356, 70.95328713113686, 24.667372176288936, 82.92852778468453, 54.56829745732159, 54.97165131151669, 58.41032193359319, 57.35756208765829, 31.095724684997105, 33.76668082011115, 41.97034964701022, 64.90347606729252, 13.859799027172691, 33.03425544996763, 56.970826203755884, 60.81553983860858, 72.17329601403807, 48.90330612363889, 84.18998268910637, 42.743910407785, 53.1847430962075, 23.766415151632202, 39.27919527197754, 67.73170622140438, 42.77464802404069, 47.47190734578793, 86.0863268285421, 84.86980585661053, 1.8871384501351396, 26.109056309017998, 57.32784119633001, 23.979392002188348, 55.68213283930269, 37.90912270752701, 42.29569697985903, 33.66410523474303, 40.641613193023794, 31.40689603351825, 16.32716335940515, 50.39590077505901, 13.549705137251378, 48.07996290590317, 65.30389491892826, 55.39701270305027, 80.4081735663533, 81.62486525733021, 44.12223520894114, 3.819629673637659, 23.52758380385683, 98.91264576542478, 14.045102456531, 12.164585810876238, 76.38367756092583, 48.150096640289384, 85.25098133085459, 99.97906550169296, 84.20963098269432, 80.43775175678645, 45.83535245049334, 76.33735707828563, 53.40211729894975, 54.0399008831273, 18.681953551523765, 88.05194344374353, 6.2256055295933255, 81.28187731758715, 82.38726846356212, 90.47879948712381, 14.571044645214904, 81.26548313801297, 3.824167324821537, 30.261479385706735, 45.85151377279831, 91.76947953912915, 37.177184361535964, 92.27639068727827, 24.54987827479713, 91.51980693829266, 63.690147001841346, 69.43508635455548, 12.407628552343386, 87.67415927032006, 34.18272389752347, 24.748436622023164, 53.22483300295989, 7.6830678652671125, 30.698112122323685, 59.3865539840831, 37.358669065026675, 89.53053750194576, 1.2977340353756084, 98.40899691828878, 63.49089102333772, 78.78021996830023, 22.131703913730295, 43.855745736395946, 58.00231556405372, 58.47569257041049, 80.29829911271344, 91.7876830305673, 16.31246860193668, 56.77517940035113, 93.13469748213944, 58.028793057370564, 67.05352670906454, 92.65078357687602, 63.28389443937294, 69.3274938900538, 80.21491061755438, 73.3808782251297, 91.14166079983639, 93.54478061264287, 43.46602489473801, 94.16393883421702, 11.831477986687922, 60.34412287876657, 95.92105094754673, 90.90542327551616, 88.76370557708685, 96.67983647323302, 94.77105507951832, 24.89132149246408, 35.604289709931805, 45.20762549289539, 35.95363704796243, 51.786676187784465, 80.17486131944412, 81.29356306268485, 3.8157256485164326, 7.259983942969472, 40.648307419775435, 90.10697908733485, 47.96299631335078, 77.31123589166309, 38.78277489850762, 42.87960082216886, 75.75153329023736, 18.002854252245758, 48.94371548059605, 14.320847183017072, 3.746795032062744, 56.965406199212666, 91.4835320861221, 32.76251578884156, 64.59252970177415, 99.42185539105385, 21.37090070220212, 71.93943659342341, 4.684758841533387, 14.804162409155897, 22.383388168026187, 40.449842535438975, 77.00114901776661, 43.27457754583261, 58.619712846845, 64.41194546721395, 72.40121903927597, 21.573149226120204, 78.02059801579819, 54.262005772219645, 70.18094501243195, 32.30397054040882, 41.80253990969357, 68.09047722198125, 49.7232167961033, 51.262562052136964, 73.41121213940757, 67.96090374788983, 60.641689488421115, 83.15671407074564, 35.23951175659644, 41.44840542781505, 38.10893423058849, 53.619008227894824, 36.64210661201566, 70.92520734881093, 77.8857681513806, 5.698245847633876, 55.21863230383459, 16.85008505718476, 48.56133927661398, 15.787048165558183, 37.14970023768318, 72.59183611558657, 96.77436973467915, 75.51993322833671, 85.52148342400693, 69.42069182142716, 12.83497137374978, 31.422523122040545, 85.32211587133116, 34.58415392082538, 69.84911487486272, 94.69697420399115, 39.39439630662205, 52.65104963502926, 93.85813533291322, 98.67977853014533, 44.54031673865355, 89.96434686981675, 88.6814043712367, 46.07258090479209, 92.31757443543202, 97.02847152797051, 3.284650168396608, 9.03155307974598, 43.96581386474382, 3.294860097020036, 28.26353140751778, 12.676457383773776, 40.059873213759104, 6.982841448443988, 67.76365786528326, 39.86556386982147, 74.34619702034645, 0.5636930135607843, 13.729107760432612, 3.676218117364005, 31.786528092583165, 10.798516907532441, 14.241527216861883, 54.01833965529711, 52.85169582385154, 63.40063620328228, 17.35544014726772, 37.00022842063814, 89.48196807866547, 45.58097433128449, 92.78539859822475, 16.513533865613095, 70.7525424849272, 21.664481725951447, 63.16657037301169, 14.452054049018038, 36.027569201044194, 16.037428782460918, 39.78497527308761, 83.24916169498174, 58.2434117253, 23.770769251650314, 87.2187208620983, 84.58065277513313, 71.88736880704528, 52.18150972738346, 3.5521226186948085, 22.24587046668731, 82.35588666007683, 14.162204754272768, 37.455574631195134, 31.491264081204495, 74.85924608291994, 41.7929905720683, 82.79707797016083, 84.61216630580311, 50.14314471488899, 69.3826258619083, 34.64776562328331, 60.32575646242169, 84.65470451114977, 17.52888481987234, 3.8908563108364547, 87.84465479003808, 38.35337001311123, 63.30644448356995, 1.175468250766798, 34.75020546919555, 73.78735226392715, 13.469672343913853, 46.51297455675491, 11.126013547680259, 17.91789894867486, 10.311443287625687, 56.21058036915336, 66.2721914065994, 75.33956571803687, 13.396375620148282, 8.208748003560974, 0.3555478312630589, 75.06821140878904, 33.00437236074751, 1.7144993012003118, 94.46209081557829, 91.62740503904818, 44.115962869467296, 26.59171562874365, 40.881365410606165, 51.54753884671172, 47.385664839462, 17.099097342084402, 67.6485616455492, 91.61403670402095, 16.16605811749122, 61.985665677848864, 41.421845493534725, 77.23544934244974, 40.6746265276492, 33.596767233799326, 1.3765469459169455, 25.09736303216944, 88.67197532353919, 48.38622427456897, 9.302007770503462, 26.77167232101214, 43.63852530641419, 50.911783471131585, 35.47211701287756, 88.60877904152868, 28.48438415560528, 6.768543860271404, 41.42728374732191, 9.013419860906236, 19.023412425612328, 79.25652282937469, 71.41668874004836, 23.956412339083922, 16.18382650521304, 48.80696345432148, 77.30513751643608, 97.78684581367285, 92.99972099900754, 69.43360042602393, 46.39941920217969, 66.72973300686034, 74.37515853895569, 49.573068118336636, 50.982513831667596, 22.687157958619707, 17.358314708182753, 9.862923678668789, 71.92169292236507, 71.75466618646061, 79.8198253185855, 44.333971970211394, 88.90490410814714, 70.94932716564078, 54.44618691762207, 68.36458823916756, 84.62626736899654, 64.06464361567274, 22.573300127468432, 46.260920993992336, 9.823167347913031, 55.60237575472758, 49.83844371775441, 80.8448570887929, 88.50682232579217, 21.12278357364622, 97.45599268094314, 94.37051759073492, 67.69139377977518, 22.78996022002, 7.099788551031838, 27.75516662185359, 89.74893617760665, 68.02766619982641, 71.82756241851024, 10.53966115913223, 97.37343979431667, 4.527502415113083, 8.234207419905514, 74.09560149631848, 69.34096376359948, 80.52253763181251, 87.92285504758036, 23.07959263986479, 38.226248548784426, 34.506426615447296, 11.706134985968985, 92.21646710666073, 76.46296557553589, 7.056493713666001, 26.446345471726307, 66.75530986473588, 6.915425623602777, 60.32043203825823, 41.343486977476765, 55.74020882248729, 26.21278311982357, 18.762667949122115, 7.5486378349735155, 78.84155698153441, 18.28125194817166, 57.08785483044196, 67.46786781980164, 16.813245135653474, 89.13022907490262, 42.919830274184356, 58.50166453401795, 6.943163062204261, 5.5999344352792635, 54.260138496241495, 17.524946041661625, 90.40012961140621, 51.88451902763088, 87.79143252974502, 7.832694460820633, 41.767243320447655, 97.03950013440931, 90.26907522798066, 26.13540672964473, 84.855489115896, 18.269203016092295, 46.7842189524034, 48.17261193473799, 70.8402206022891, 20.88627575814478, 34.356053700841926, 85.8825656284148, 90.57953088583628, 81.87712776928907, 26.53198103163573, 54.163579613400955, 9.454203766463598, 39.027741070447306, 37.11341379241614, 59.32617937406239, 13.310393501163576, 59.30699405203187, 9.94984052850093, 10.288173065535332, 71.26145232284736, 49.042202986342744, 57.15760551646712, 94.35816709755885, 29.821630170771652, 29.753673399411696, 63.277798105020246, 52.33154404740657, 53.343555410144184, 45.965373897718145, 22.96283958465851, 18.96491405008307, 56.09404595136854, 25.81006689503107, 15.752381372535273, 83.786865729765, 41.671971324531654, 4.466827268511353, 26.326266261806797, 46.44674008377336, 97.40203920660278, 92.46254901588082, 9.071819011937777, 0.29872629378351334, 6.727080745881631, 22.043962024777485, 6.4163206467631735, 59.45529245924327, 64.24586907950165, 20.546438631471297, 0.5949690367275773, 61.61006356456611, 71.67209026759419, 79.25514640310692, 3.130627020074428, 87.45647947719547, 16.695632293528597, 21.98469421774727, 42.59060653616802, 19.87292024591477, 37.693627258188144, 79.69857559623426, 47.75284343625694, 22.64188844303323, 63.42700910071509, 53.93466877655088, 52.47626348054418, 73.06266366149326, 94.90795963568132, 89.17662631174616, 57.973254099232975, 2.931553116559815, 28.69372500347225, 10.236608356926713, 55.99389751581367, 50.0751996044763, 65.28249192141085, 51.19654165787746, 76.81806934175812, 40.25621147134697, 79.72073984074662, 46.451397960538344, 98.41937181349508, 68.48206189624683, 42.243099861230874, 63.2096495381775, 81.61622972060239, 33.85335122449975, 62.0753197725119, 14.940655118821589, 17.264124948451887, 33.82020121012509, 3.7713848270381933, 59.02449215483725, 96.07323812021696, 14.597167424280478, 70.4493428565429, 92.27540612489709, 57.13655823227396, 99.18950947752336, 2.572889079621654, 35.17227112400397, 62.80285130515539, 64.4457173864253, 4.081790412213781, 33.935209942282555, 47.21948446771166, 40.533329597264775, 71.43042061007084, 41.24143086264718, 76.21711157656588, 57.325686206111634, 72.52246944647601, 97.06683604062981, 85.92888840166127, 69.28341261634733, 44.44141949809224, 4.413491397681579, 21.166947695550697, 92.91283058277449, 85.43274828892649, 14.661385141458661, 58.841677467386525, 38.14442753205053, 65.35219504579156, 11.757018667715569, 37.02453591363416, 51.89568201180149, 14.807623738566777, 47.4690389959506, 43.94426678155594, 53.54991159319833, 98.65431023046625, 49.77750047045916, 91.53331564579148, 82.59154092690937, 10.830498448794511, 23.604470783137653, 4.913912806646659, 89.39176856718876, 75.63648885250515, 28.879812577312013, 56.37550922195307, 4.540743287578541, 99.34829283144948, 92.84663320513245, 30.320240592172354, 82.87740133518996, 60.42961188509817, 22.437859310112064, 57.03001687154067, 9.945141607830942, 72.79912133152429, 10.819552608459448, 57.632418216699435, 62.58557165455441, 38.042941666232096, 56.84221813425896, 62.645598142112014, 71.5238104595084, 56.60196293149602, 31.73814512530484, 80.50919591292809, 54.98613391349737, 21.46397128910974, 53.856506428650356, 15.819973648633779, 92.69170852679478, 64.5403084713304, 46.090595832493776, 73.02983312602575, 29.626017993023936, 41.322197483597144, 86.7005554164061, 62.35142622234399, 91.35109832915805, 78.50799858987301, 29.274900608266798, 94.09057573806345, 10.101363285081089, 77.9681756592891, 62.82618771368972, 15.714171889460937, 47.233706117472295, 68.4374101158683, 43.263368694460866, 10.94524967781938, 46.2460787578612, 36.640309023987236, 45.98804115382238, 65.2649588618062, 45.219760665912645, 21.401040141354777, 11.900083762575676, 90.09209294566313]
x_train = np.array(x_values , dtype = np.float32)
x_train = x_train.reshape(-1 , 1)
print(x_train.shape)

y_values = [2 * i + 1 for i in x_values]
y_train = np.array(y_values , dtype = np.float32)
y_train = y_train.reshape(-1 , 1)
print(y_train.shape)

class LinearRegressionModule(nn.Module):
    def __init__(self , input_dim , output_dim):
        super(LinearRegressionModule , self).__init__()
        self.linear = nn.Linear(input_dim , output_dim)

    def forward(self , x):
        out = self.linear(x)
        return out

input_dim = 1
output_dim = 1

model = LinearRegressionModule(input_dim , output_dim)
print(model)

epochs = 50000 #训练的总次数
learning_rate = 0.0001 #训练下降速度
optimizer = torch.optim.SGD(model.parameters() , lr = learning_rate) #设置优化器
criterion = nn.MSELoss()

for epoch in range(epochs):
    epoch += 1
    #将输入转化成torch的格式
    inputs = torch.from_numpy(x_train)
    labels = torch.from_numpy(y_train)

    #每次迭代要清空梯度
    optimizer.zero_grad()

    #向前传递
    outputs = model(inputs)

    #计算loss
    loss = criterion(outputs , labels)

    loss.backward()

    optimizer.step()
    if epoch % 500 == 0 :
        print('epoch {}  ,  loss {}'.format(epoch , loss.item()))

predicted = model(torch.from_numpy(x_train).requires_grad_()).data.numpy()
print(predicted)
    
#保存模型的参数
torch.save(model.state_dict(),'model2.pkl')
#读取保存的参数
model.load_state_dict(torch.load('model.pkl'))